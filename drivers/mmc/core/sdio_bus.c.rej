--- drivers/mmc/core/sdio_bus.c
+++ drivers/mmc/core/sdio_bus.c
@@ -263,10 +263,17 @@ static void sdio_release_func(struct device *dev)
 {
 	struct sdio_func *func = dev_to_sdio_func(dev);
 
-	sdio_free_func_cis(func);
+	if (!(func->card->quirks & MMC_QUIRK_NONSTD_SDIO))
+		sdio_free_func_cis(func);
 
-	kfree(func->info);
+	/*
+	 * We have now removed the link to the tuples in the
+	 * card structure, so remove the reference.
+	 */
+	put_device(&func->card->dev);
 
+	kfree(func->info);
+	kfree(func->tmpbuf);
 	kfree(func);
 }
 
