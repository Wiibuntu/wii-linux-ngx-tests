--- drivers/pwm/pwm-lpc18xx-sct.c
+++ drivers/pwm/pwm-lpc18xx-sct.c
@@ -408,12 +402,10 @@ static int lpc18xx_pwm_probe(struct platform_device *pdev)
 					      GFP_KERNEL);
 		if (!pwm->chip_data) {
 			ret = -ENOMEM;
-			goto remove_pwmchip;
+			goto disable_pwmclk;
 		}
 	}
 
-	platform_set_drvdata(pdev, lpc18xx_pwm);
-
 	val = lpc18xx_pwm_readl(lpc18xx_pwm, LPC18XX_PWM_CTRL);
 	val &= ~LPC18XX_PWM_BIDIR;
 	val &= ~LPC18XX_PWM_CTRL_HALT;
